<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <script src="/webjars/vue/3.2.45/dist/vue.global.js"></script>
    <script src="/webjars/axios/1.3.4/dist/axios.js"></script>
    <link rel="icon" href="/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vite App</title>
  </head>
  <body>
    <div id="app"></div>

    <script>

export default({
    data() {
        return{
            dbname: '',
            keyprefix: '',
            keyinfo: '',
            selectedkeyprefix: '',
            result: ''
        }
    },
    created() {
        this.fetchKeyPrefix()
    },
    methods: {
        hasValidInput() {
            return this.dbname.trim() && this.selectedkeyprefix.trim() && this.keyinfo.trim()
        },
        async search() {
            if(this.hasValidInput()) {
                const url = '/api/data/getData?keyPrefix='+this.selectedkeyprefix +"&keyInfo=" + this.keyinfo
                this.result = await (await fetch(url)).text()
            } else {
                alert('invalid')
            }
        },
        async fetchKeyPrefix() {
            const url = '/api/data/getkeyprefix?dbname='+this.dbname
            this.keyprefix = await (await fetch(url)).json()
            // this.keyprefix = ['Prefix-1', 'Prefix-2', 'Prefix-3']
        }
    }
})
</script>
<!--    <script type="module" src="/dist/js/main.js"></script>-->

    <div class="left">
      <span>Name:</span>
      <br>
      <select v-model="dbname" @change="fetchKeyPrefix" >
        <option disabled value=""> select db name </option>
        <option>DB-1</option>
        <option>DB-2</option>
      </select>
      <br>
      <br>
      <span>Key prefix: </span>
      <br>
      <select size=5 v-model="selectedkeyprefix">
        <option v-for="prefix in keyprefix" :key="prefix">{{ prefix }}</option>
      </select>
      <br>
      <br>
      <span >Key Info:</span>
      <input v-model="keyinfo" >
      <br>
      <button @click="search">Search</button>
      <br>
      <br>
    </div>
    <div class="right">
      <span>Result:</span>
      <br>
      <textarea rows=15 cols=28 v-model="result" placeholder="no result found"></textarea>
    </div>
  </body>
</html>
